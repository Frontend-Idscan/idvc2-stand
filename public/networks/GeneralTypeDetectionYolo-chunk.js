(self.webpackChunk_idscan_idvc2=self.webpackChunk_idscan_idvc2||[]).push([[9],{7358:(t,e,n)=>{n.r(e),n.d(e,{default:()=>Z});var r=n(4554),o=n(813),i=n(4328),u=n(7286),a=n(8736),c=n(6955),l=n(528),f=n(683);function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function h(t){if(Array.isArray(t))return t}function p(t){if(Array.isArray(t))return s(t)}function y(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(t,e,n,r,o,i,u){try{var a=t[i](u),c=a.value}catch(t){n(t);return}a.done?e(c):Promise.resolve(c).then(r,o)}function b(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function u(t){d(i,r,o,u,a,"next",t)}function a(t){d(i,r,o,u,a,"throw",t)}u(void 0)})}}function v(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function m(t,e,n){return e&&g(t.prototype,e),n&&g(t,n),t}function w(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S(t){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function I(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_(t,e)}function T(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function k(t,e){var n,r,o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=o){var i=[],u=!0,a=!1;try{for(o=o.call(t);!(u=(n=o.next()).done)&&(i.push(n.value),!e||i.length!==e);u=!0);}catch(t){a=!0,r=t}finally{try{u||null==o.return||o.return()}finally{if(a)throw r}}return i}}function A(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function C(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function O(t,e){return e&&("object"===j(e)||"function"==typeof e)?e:y(t)}function _(t,e){return(_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function x(t,e){return h(t)||k(t,e)||D(t,e)||A()}function P(t){return p(t)||T(t)||D(t)||C()}function j(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}function D(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(t,e)}}function M(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function R(t){var e=M();return function(){var n,r=S(t);if(e){var o=S(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return O(this,n)}}function E(t,e){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=(o=u.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=e.call(t,u)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}var z={confidence:.5,classes:["BACKS_MRZ","BACKS_MRZPDF","BACKS_NO","BACKS_PDF","BCC","CAC","CREDITCARDS","DLIC","EA","GC","IID","MID_NEW","MID_OLD","PASSP","PC","VA","VHC"],inputImageWidth:320,inputImageHeight:320,inputTensorSize:[1,320,320,3],inputTensorName:"image_input",outputTensorSize:[1,21,2100],outputTensorName:"Identity"},W=function(t){"use strict";I(n,t);var e=R(n);function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.z.WASM,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return v(this,n),e.call(this,t,r,i)}return m(n,[{key:"predictFromImage",value:function(t,e,n,r){var o=this;return b(function(){var n,r,i,u,a,c,s;return E(this,function(h){switch(h.label){case 0:if(o.loading)return[2,{}];return o.loading=!0,n=o.createSrc(t,"angles-input-canvas"),r=e||(0,l.vL)("general-type-canvas",{width:z.inputImageWidth,height:z.inputImageHeight}),i=(0,l.RT)({width:r.width,height:r.height},{width:n.width,height:n.height}),(u=r.getContext("2d")).fillStyle="rgb(114, 114, 114)",u.fillRect(0,0,r.width,r.width),u.drawImage(n,i.x,i.y,i.width,i.height),a=(0,f.Di)(u.getImageData(0,0,r.width,r.height),f.eQ.WITHOUT),console.time("generalType predict"),[4,o.predict(a)];case 1:return c=h.sent(),console.timeEnd("generalType predict"),console.log("<---------------------------------------------------------------->"),(s=o.processOutput(c[z.outputTensorName].data,r.width,r.height)).length?(console.log("ВЫХОД",s[0][4]),console.log("confidence",s[0][5])):console.log("low confidence"),o.loading=!1,[2,s]}})})()}},{key:"processOutput",value:function(t,e,n){for(var r=function(r){var o=P(Array(z.classes.length).keys()).map(function(e){return[e,t[u*(e+4)+r]]}).reduce(function(t,e){return e[1]>t[1]?e:t},[0,0]);if(o[1]<z.confidence)return"continue";var a=z.classes[o[0]],c=t[r],l=t[u+r],f=t[2*u+r],s=t[3*u+r],h=(c-f/2)/z.inputImageWidth*e,p=(l-s/2)/z.inputImageHeight*n,y=(c+f/2)/z.inputImageWidth*e,d=(l+s/2)/z.inputImageHeight*n;i.push([h,p,y,d,a,o[1]])},o=this,i=[],u=z.outputTensorSize[z.outputTensorSize.length-1],a=0;a<u;a+=1)r(a);i=i.sort(function(t,e){return e[5]-t[5]});for(var c=[];i.length>0;)c.push(i[0]),i=i.filter(function(t){return .2>o.iou(i[0],t)});return c}},{key:"iou",value:function(t,e){return this.intersection(t,e)/this.union(t,e)}},{key:"union",value:function(t,e){var n=x(t,4),r=n[0],o=n[1],i=n[2],u=n[3],a=x(e,4),c=a[0],l=a[1];return(i-r)*(u-o)+(a[2]-c)*(a[3]-l)-this.intersection(t,e)}},{key:"intersection",value:function(t,e){var n=x(t,4),r=n[0],o=n[1],i=n[2],u=n[3],a=x(e,4),c=a[0],l=a[1];return(Math.min(i,a[2])-Math.max(r,c))*(Math.min(u,a[3])-Math.max(o,l))}},{key:"xywh2xyxy",value:function(t){return t.map(function(t){var e=x(t,4),n=e[0],r=e[1],o=e[2],i=e[3];return[n-o/2,r-i/2,n+o/2,r+i/2]})}},{key:"predict",value:function(t){var e=new a.Tensor("float32",t,z.inputTensorSize),n=w({},z.inputTensorName,e);return this.session.run(n)}}]),n}(c.Z);function B(t,e,n,r,o,i,u){try{var a=t[i](u),c=a.value}catch(t){n(t);return}a.done?e(c):Promise.resolve(c).then(r,o)}function H(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function u(t){B(i,r,o,u,a,"next",t)}function a(t){B(i,r,o,u,a,"throw",t)}u(void 0)})}}function N(t,e){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=(o=u.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=e.call(t,u)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}let Z=H(function(){var t;return N(this,function(e){return t=new W("".concat(r.t.JZ),o.z.WASM,i.Z.networkUrl),u.Z.setModule("model","generalTypeDetectionYolo",t),[2,[t.initialize.bind(t)]]})})}}]);